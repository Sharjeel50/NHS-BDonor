const electron = require('electron'); // declared once, no need to be declared again
const { ipcRenderer } = electron;  // same as above comment

// ------------------------------------------------------------------------------------------------

var mysql = require("mysql");
var connection = mysql.createConnection({ // Make the connection to the database
  host: "localhost",
  user: "root",
  password: null,
  database: "requestTable"
});

connection.connect((err) => { // Check if conenction is made or not
  if (err) {
    return console.log(" Connection Failed " + err);
  }
  console.log("Connected");
})

$queryString = "SELECT * FROM `requeststable`;"

connection.query($queryString, (err, rows, fields) => {
  if (err) {
    return console.log("Error with Query");
    console.log(fields);
  }
  console.log(rows);
  console.log();
  var n = rows.length;
  var s = '<table>';
  for(var i = 0; i < n; i ++){
    var work = rows.items(i);
    s += '<tr>';
    s += '<td>' + work.request_id + '</td>'
    s += '<td>' + work.request_type + '</td>'
    s += '<td>' + work.blood_type + '</td>'
    s += '<td>' + work.notice + '</td>'
    s += '<td>' + work.date + '</td>'
    s += '</tr>';
  }
  s += '</table>'
  document.getElementById('results').innerHTML = s;
})


// --------------------------------------------------------------------------------------------


// Dont mess with this shit for now

 ipcRenderer.on('setupData', function (e, hospitalName, streetAddress, cityName, postalCode) {
     document.title = hospitalName + " " + "|" + cityName + " " + "|" + streetAddress
 })

 // Search Bar -- Dont Touch
 function myFunction() {

     input = document.getElementById("myInput");
     filter = input.value.toUpperCase();
     table = document.getElementById("donorContents");
     tr = table.getElementsByTagName("tr");
     for (i = 0; i < tr.length; i++) {
         td = tr[i].getElementsByTagName("td")[0];
         if (td) {
             txtValue = td.textContent || td.innerText;
             if (txtValue.toUpperCase().indexOf(filter) > -1) {
                 tr[i].style.display = "";
             } else {
                 tr[i].style.display = "none";
             }
         }
     }
 }


// Open window with myFunction
//function viewWindow(){
  //console.log("Working")
//  main.openWindow('createDonorWindow')
//}
